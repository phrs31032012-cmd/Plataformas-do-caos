<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jogo das Plataformas</title>
  <style>
    body {
      margin: 0;
      background: #111;
      overflow: hidden;
    }
    canvas {
      display: block;
      margin: auto;
      background: #000;
    }
    #score {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      color: #0ff;
      font-size: 30px;
      font-weight: bold;
    }
    #lives {
      position: absolute;
      top: 10px;
      left: 10px;
      color: #f00;
      font-size: 25px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="score">Pontos: 0</div>
  <div id="lives">Vidas: 3</div>
  <canvas id="gameCanvas" width="500" height="600"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let player = { x: canvas.width/2 - 20, y: canvas.height-80, w: 40, h: 40, vx: 0, vy: 0 };
    let gravity = 0.5;
    let jump = -10;
    let platforms = [];
    let score = 0;
    let maxY = player.y;
    let lives = 3;
    let difficulty = 1;

    function createPlatform(x, y, w=100, h=20, color="#0ff") {
      platforms.push({x, y, w, h, color});
    }

    function resetPlatforms(){
      platforms = [];
      // plataforma inicial branca (maior e segura)
      createPlatform(canvas.width/2 - 100, canvas.height-50, 200, 20, "#fff");
      // primeiras plataformas azuis mais próximas
      for(let i=0;i<5;i++){
        let x = 150 + i*130;
        let y = canvas.height - 150 - i*50;
        createPlatform(x, y);
      }
    }

    resetPlatforms();

    // controles
    document.addEventListener("keydown", e=>{
      if(e.key==="ArrowLeft") player.vx=-5;
      if(e.key==="ArrowRight") player.vx=5;
      if(e.key===" " && player.vy===0) player.vy=jump;
    });
    document.addEventListener("keyup", e=>{
      if(e.key==="ArrowLeft" || e.key==="ArrowRight") player.vx=0;
    });

    function gameLoop(){
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // aplicar gravidade
      player.vy += gravity;
      player.x += player.vx;
      player.y += player.vy;

      // colisão com plataformas
      platforms.forEach(p=>{
        if(player.x < p.x+p.w && player.x+player.w > p.x &&
           player.y+player.h > p.y && player.y+player.h < p.y+p.h && player.vy>=0){
          player.vy = jump;
          if(p.color==="#0ff"){
            score++;
            document.getElementById("score").innerText = "Pontos: " + score;
          }
        }
      });

      // dificuldade aumenta a cada 100 pontos
      if(score > 0 && score % 100 === 0){
        difficulty = 1 + Math.floor(score/100);
      }

      // desenhar player
      ctx.fillStyle = "#ff0";
      ctx.fillRect(player.x, player.y, player.w, player.h);

      // desenhar plataformas
      ctx.fillStyle = "#0ff";
      platforms.forEach(p=>{
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x,p.y,p.w,p.h);
        if(p.color==="#0ff"){
          p.y += 0.5 * difficulty; // caem mais rápido com a dificuldade
        }
      });

      // limites da tela
      if(player.x<0) player.x=0;
      if(player.x+player.w>canvas.width) player.x=canvas.width-player.w;

      // queda do player
      if(player.y > canvas.height){
        lives--;
        if(lives > 0){
          // volta do início com pontos preservados
          player.x = canvas.width/2 - 20;
          player.y = canvas.height - 80;
          player.vx = 0;
          player.vy = 0;
          resetPlatforms();
        } else {
          // game over → reset total
          lives = 3;
          score = 0;
          difficulty = 1;
          resetPlatforms();
          player.x = canvas.width/2 - 20;
          player.y = canvas.height - 80;
          player.vx = 0;
          player.vy = 0;
        }
        document.getElementById("lives").innerText = "Vidas: " + lives;
        document.getElementById("score").innerText = "Pontos: " + score;
      }

      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>